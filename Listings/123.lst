C51 COMPILER V9.60.0.0   123                                                               07/31/2019 10:20:15 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE 123
OBJECT MODULE PLACED IN .\Objects\123.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE User\123.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\User) DEBUG OBJECTEXTEND PR
                    -INT(.\Listings\123.lst) TABS(2) OBJECT(.\Objects\123.obj)

line level    source

   1          /**
   2              实现蓝牙发送数据控制电机电机正转和反转 以及 改变转速
   3              发送  0 实现顺时针正转
   4                    1 实现逆时针反转
   5                    2 实现转速为慢速
   6                    3 实现转速为中速
   7                    4 实现转速为快速
   8              运用的LCD1602作为显示
   9                    E = P2 ^ 7;   //1602使能引脚
  10                    RW = P2 ^ 6;    //1602读写引脚
  11                    RS = P2 ^ 5;    //1602数据/命令选择引脚
  12              如有不同在lcd.h中修改引脚参数
  13              **重要：
  14                  因为用的ULN2003芯片，所以对应的引脚
  15                    IN1 --  P1^6
  16                    IN2 --  P1^5
  17                    IN3 --  P1^4
  18                    IN4 --  P1^3
  19                    OUT1  --  橙色线
  20                    OUT2  --  黄色线
  21                    OUT3  --  粉色线
  22                    OUT4  --  蓝色线
  23                  剩下红色接VCC，建议LCD1602和步进电机以及单片机都分开供电
  24              
  25          **/
  26          #include "123.h"
  27          
  28          main()
  29          {
  30   1          L1602_init();
  31   1          Delay(100);
  32   1          UartInit();
  33   1          while(1)
  34   1          {
  35   2             if(flag == 0)
  36   2              {
  37   3                led = 0;
  38   3                
  39   3                forward(speed);
  40   3                
  41   3                if(speed == 1)
  42   3                {
  43   4                 LCD_display("Mo Dir: Goto","Mo Spd: Fast ^_^");
  44   4                }
  45   3                
  46   3                else if(speed == 3)
  47   3                {
  48   4                 LCD_display("Mo Dir: Goto","Mo Spd: Norl ^_^");
  49   4                }
  50   3                
  51   3                else if(speed == 5)
  52   3                {
  53   4                 LCD_display("Mo Dir: Goto","Mo Spd: Slow ^_^");
  54   4                }
C51 COMPILER V9.60.0.0   123                                                               07/31/2019 10:20:15 PAGE 2   

  55   3      //          switch(speed)   //switch无法实现不知道为什么，知道的大佬求解释
  56   3      //          {
  57   3      //        case'1':
  58   3      //          LCD_display("Mo Dir: Goto","Mo Spd: Fast ^_^");
  59   3      //        case'2':
  60   3      //          LCD_display("Mo Dir: Goto","Mo Spd: Norl ^_^");
  61   3      //        case'3':
  62   3      //          LCD_display("Mo Dir: Goto","Mo Spd: Slow ^_^");
  63   3      //          }
  64   3              }
  65   2      
  66   2      
  67   2             if(flag == 1)
  68   2              {
  69   3                led = 1;
  70   3                back(speed);
  71   3                if(speed == 1)
  72   3                {
  73   4                 LCD_display("Mo Dir: Back","Mo Spd: Fast ^_^");
  74   4                }
  75   3                else if(speed == 3)
  76   3                {
  77   4                 LCD_display("Mo Dir: Back","Mo Spd: Norl ^_^");
  78   4                }
  79   3                else if(speed == 5)
  80   3                {
  81   4                 LCD_display("Mo Dir: Back","Mo Spd: Slow ^_^");
  82   4                }
  83   3      //        switch(speed)
  84   3      //          {
  85   3      //        case'1':
  86   3      //          LCD_display("Mo Dir: Back","Mo Spd: Fast ^_^");
  87   3      //        break;
  88   3      //        case'2':
  89   3      //          LCD_display("Mo Dir: Back","Mo Spd: Norl ^_^");
  90   3      //        break;
  91   3      //        case'3':
  92   3      //          LCD_display("Mo Dir: Back","Mo Spd: Slow ^_^");
  93   3      //        break;
  94   3      //          }
  95   3              }
  96   2      
  97   2          }
  98   1      }
  99          
 100          void Usart() interrupt 4
 101          {
 102   1          uchar n; //定义临时变量
 103   1      //  led = 1;
 104   1          if(RI) //判断是接收中断产生
 105   1          {
 106   2              RI = 0; //标志位清零
 107   2              n = SBUF; //读入缓冲区的值
 108   2              switch(n)
 109   2              {
 110   3              case'0':    //控制正转
 111   3                flag = 0;
 112   3               break;
 113   3              
 114   3              case'1':    //控制反转
 115   3                flag = 1;
 116   3               break;
C51 COMPILER V9.60.0.0   123                                                               07/31/2019 10:20:15 PAGE 3   

 117   3              
 118   3              case'2':    //控制速度为慢
 119   3                speed = 5;
 120   3              break;
 121   3              
 122   3              case'3':    //控制速度为中等
 123   3                speed = 3;
 124   3              break;
 125   3              
 126   3              case'4':    //控制速度为快
 127   3                speed = 1;
 128   3              break;
 129   3              
 130   3              }
 131   2              TI = 1;
 132   2              SBUF = n; //把接收到的值再发回
 133   2          }
 134   1          if(TI) //如果是发送标志位，清零
 135   1              TI = 0;
 136   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    257    ----
   CONSTANT SIZE    =     77    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
